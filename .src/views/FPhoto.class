' Gambas class file

Private $photo As PhotoEntity
Private $pictureBox As PictureBox

Public Sub _new(photo As PhotoEntity)

  $photo = photo

  ButtonSeleccionar.Top = 4
  ButtonSeleccionar.Left = 4

  $pictureBox = New PictureBox(Me)
  $pictureBox.X = 0
  $pictureBox.Y = 0
  $pictureBox.Width = Me.Width
  $pictureBox.Height = Me.Height
  $pictureBox.Padding = 8
  $pictureBox.Mode = PictureBox.Contain
  $pictureBox.Expand = True
  $pictureBox.Alignment = Align.Center
  If photo.HasThumbnail Then
    $pictureBox.Image = Image.FromString($photo.Thumbnail)
  Else
    $pictureBox.Image = Image.Load($photo.ImagePath &/ $photo.FileName)
  Endif

End

Public Sub Form_Open()

End

Public Sub Form_Resize()

  Me.Height = Me.Parent.Height
  Me.Width = Me.Parent.Width
  $pictureBox.Height = Me.Height
  $pictureBox.Width = Me.Width

End

Public Sub Form_Arrange()

  ' Me.Height = Me.Parent.Height
  ' Me.Width = Me.Parent.Width
  ' PictureBoxPhoto.Height = Me.Parent.Height
  ' PictureBoxPhoto.Width = Me.Parent.Width

End

Public Sub Form_Activate()

  ' Me.Height = Me.Parent.Height
  ' Me.Width = Me.Parent.Width
  ' PictureBoxPhoto.Height = Me.Parent.Height
  ' PictureBoxPhoto.Width = Me.Parent.Width

End

Public Sub Form_State()

  ' Me.Height = Me.Parent.Height
  ' Me.Width = Me.Parent.Width
  ' PictureBoxPhoto.Height = Me.Parent.Height
  ' PictureBoxPhoto.Width = Me.Parent.Width

End

Public Sub PictureBoxPhoto_Enter()

End

Public Sub PictureBoxPhoto_Leave()

End

Public Sub Form_Enter()

  ButtonSeleccionar.Visible = True
  ButtonSeleccionar.Raise()

End

Public Sub Form_Leave()

  ButtonSeleccionar.Visible = False

End

Public Sub ButtonSeleccionar_Click()

  ' PictureBoxPhoto.Background = Color.Blue
  Form.Refresh

End
